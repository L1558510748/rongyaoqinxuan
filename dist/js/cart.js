"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var l=0;l<e.length;l++){var n=e[l];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,l){return e&&_defineProperties(t.prototype,e),l&&_defineProperties(t,l),t}var Cart=function(){function t(){_classCallCheck(this,t),this.quit=document.getElementById("quit"),this.status=0,this.user="",this.all=0,this.price=0,this.data="",this.sum=0,this.addEvent()}return _createClass(t,[{key:"addEvent",value:function(){var t=this;this.quit.onclick=function(){t.logout()},this.check(),this.init()}},{key:"logout",value:function(){sessionStorage.removeItem("user"),location.reload()}},{key:"check",value:function(){var t=sessionStorage.getItem("user");t&&(console.log($("#username").html()),$(".user_info").css("display","none"),$(".logined").css("display","block"),$("#username").html(JSON.parse(t).sucMsg),this.user=JSON.parse(t).sucMsg)}},{key:"init",value:function(){var o=this;$.ajax({type:"get",url:"http://localhost/rongyaoqinxuan/src/static/php/cart2.php",data:{user:this.user},success:function(t){if(console.log(t),t=t.split(","),console.log(t),t.pop(),console.log(t.length),o.data=t,this.status=1,0<t.length){$(".tips").css("display","none"),$(".shoppingcart").css("display","block"),console.log(1111);for(var e="",l=1,n=0;n<t.length/6;n++){console.log(n);var a=t[n+2+l]*t[n+1+l];o.sum+=a,e+='<div id="'.concat(t[n+l],'"><ul><li><input type="checkbox"   ></li><li><span id="namespan"><img src="').concat(t[n+3+l],'"><b>').concat(t[n+4+l],'</b></span></li><li id="price">').concat(t[n+2+l],'</li><li><input type="button" value="-" id="reduce"><span id="goodnum">').concat(t[n+1+l],'</span><input type="button" value="+" id="increase"></li><li id="total" class="total">').concat(a,'</li>\n                <li ><span id="delete">删除</span></li></ul></div>'),l+=5}$(".cart_list").html(e),$("#goodnum").html(),o.totalctrl()}}})}},{key:"totalctrl",value:function(){for(var e=this,t=0,l=0;l<$(".total").length;l++)t+=+$(".total").eq(l).html(),console.log(+$(".total").eq(l).html());$("#allprice").html(t),$("[id=reduce]").click(function(){var t=+$(this).parent().children("span").html();if(1<t){t--,$(this).parent().children("span").html(t),$(this).parent().parent().children("#total").html(t*$(this).parent().parent().children("#price").html());for(var e=0,l=0;l<$(".total").length;l++)e+=+$(".total").eq(l).html(),console.log(+$(".total").eq(l).html());$("#allprice").html(e)}}),$("[id=increase]").click(function(){var t=+$(this).parent().children("span").html();t++,$(this).parent().children("span").html(t),$(this).parent().parent().children("#total").html(t*$(this).parent().parent().children("#price").html());for(var e=0,l=0;l<$(".total").length;l++)e+=+$(".total").eq(l).html(),console.log(+$(".total").eq(l).html());$("#allprice").html(e)}),$("[id=delete]").click(function(){console.log($(this).parent().parent().parent().html()),$(this).parent().parent().parent().remove()}),$("[id=checkall]").click(function(){if(0==e.all){e.all=1,console.log($("[type=checkbox]").length);for(var t=0;t<$("[type=checkbox]").length;t++)$("[type=checkbox]")[t].checked=!0}else for(t=e.all=0;t<$("[type=checkbox]").length;t++)$("[type=checkbox]")[t].checked=!1}),$("#deleteall").click(function(){1==e.all&&($(".shoppingcart").remove(),console.log(e.data[0]),$.ajax({type:"post",url:"http://localhost/rongyaoqinxuan/src/static/php/cart3.php",data:{user:e.data[0]}}),e.status=0,console.log(222),$(".shoppingcart").css("display","none"),$(".tips").css("display","block"))})}}]),t}();new Cart;