"use strict";function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function _createClass(t,i,e){return i&&_defineProperties(t.prototype,i),e&&_defineProperties(t,e),t}var Detail=function(){function t(){_classCallCheck(this,t),this.id=this.getUrlParam("id"),this.reduce=$("#reduce"),this.increase=$("#increase"),this.goodsid="",this.user="",this.num=1,this.status=0,this.box=$(".box"),this.index=0,this.data={},this.quit=document.getElementById("quit"),this.addEvent()}return _createClass(t,[{key:"addEvent",value:function(){this.boxscroll(),this.check();var i=this;$("#cart").click(function(){i.cart()}),this.quit.onclick=function(){this.status=0,i.exit()},console.log($("#quit").html()),$(".bigpic").mouseover(function(){i.over()}),$(".bigpic").mousemove(function(t){i.move(t)}),$(".bigpic").mouseout(function(){i.out()}),this.getdata(),$(this.reduce).click(function(){1<i.num&&$("#num").html(--i.num)}),$(this.increase).click(function(){$("#num").html(++i.num)}),$(".smallpic").find("img").click(function(){var t=$(this).attr("src");$(this).addClass("active").siblings().removeClass("active"),$(".bigpic").find("img").attr("src",t),$(".scrollpic").find("img").attr("src",t)})}},{key:"boxscroll",value:function(){var t=0;setInterval(function(){t==$(".box>ul>li").length?(t=0,$(".box").children("ul").css("top",0)):($(".box").children("ul").animate({top:-36*t+"px"},500),t++)},3e3)}},{key:"cart",value:function(){1==this.status&&$.ajax({type:"post",url:"http://localhost/rongyaoqinxuan/src/static/php/cart.php",data:{user:this.user,goodsid:this.id,price:this.data.nowprice,imgsrc:this.data.img1,num:+$("#num").html(),goodsname:this.data.name},success:function(t){console.log(t)}})}},{key:"check",value:function(){var t=sessionStorage.getItem("user");t&&(this.status=1,console.log(JSON.parse(t).sucMsg),$(".user_info").css("display","none"),$(".logined").css("display","block"),$("#detusername").html(JSON.parse(t).sucMsg),this.user=JSON.parse(t).sucMsg)}},{key:"exit",value:function(){sessionStorage.removeItem("user"),location.reload()}},{key:"over",value:function(){$(".hoverpic").css("display","block"),$(".scrollpic").css("display","block")}},{key:"move",value:function(t){var i=t.pageX-$(".bigpic").offset().left-54,e=t.pageY-$(".bigpic").offset().top-54;i<0&&(i=0),e<0&&(e=0),i>$(".bigpic").width()-$(".hoverpic").width()&&(i=$(".bigpic").width()-$(".hoverpic").width()),e>$(".bigpic").height()-$(".hoverpic").height()&&(e=$(".bigpic").height()-$(".hoverpic").height()),$(".hoverpic").css("left",i+"px"),$(".hoverpic").css("top",e+"px");var s=i/($(".bigpic").width()-$(".hoverpic").width()),o=e/($(".bigpic").height()-$(".hoverpic").height());$("#sc1").css("left",($(".scrollpic").width()-$("#sc1").width())*s+"px"),$("#sc1").css("top",($(".scrollpic").height()-$("#sc1").height())*o+"px")}},{key:"out",value:function(){$(".hoverpic").css("display","none"),$(".scrollpic").css("display","none")}},{key:"getdata",value:function(){var e=this,s=0;0==s&&$.getJSON("http://localhost/rongyaoqinxuan/src/static/goods.json",function(t){console.log(t);for(var i=0;i<t.length;i++)if(t[i].goods_id===e.id)return e.index=i,console.log(i),e.data=t[i],void e.init();s=1,console.log("qqq")}),0==s&&$.getJSON("http://localhost/rongyaoqinxuan/src/static/zhihui.json",function(t){console.log(t);for(var i=0;i<t.length;i++)if(t[i].goods_id===e.id)return e.index=i,console.log(i),e.data=t[i],void e.init();s=2}),0==s&&$.getJSON("http://localhost/rongyaoqinxuan/src/static/jingpin.json",function(t){console.log(t);for(var i=0;i<t.length;i++)if(t[i].goods_id===e.id)return e.index=i,console.log(i),e.data=t[i],void e.init();s=3}),$("#product_name").html()}},{key:"init",value:function(){console.log(this.data),$("#product_name").html(this.data.name),$(".goods_name").html(this.data.name),$("#price").html("ï¿¥"+this.data.nowprice),$("#bp1").attr("src",this.data.img1),$("#sp1").attr("src",this.data.img1),$("#sp2").attr("src",this.data.img2),$("#sp3").attr("src",this.data.img3),$("#sc1").attr("src",this.data.img1)}},{key:"getUrlParam",value:function(t){var i=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),e=window.location.search.substr(1).match(i);if(null!=e)return unescape(e[2])}}]),t}();new Detail;